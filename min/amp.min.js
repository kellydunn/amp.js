(function(a){var b=null,b="undefined"!==typeof exports?exports:this.Amp={},d={};b.define=function(a,b,e){if("function"===typeof define&&define.amd)define(a,b,e);else{if(b&&b.length)for(var c=0;c<b.length;c++)b[c]=d[b[c]];d[a]=e.apply(this,b||[])}};"undefined"===typeof define&&(a.define=b.define)})("undefined"===typeof window?this:window);define("Amp.Apis",["Amp"],function(){Amp.Apis={}});
define("Amp.Manager",["Amp"],function(){Amp.Manager={ZOOM:100,range:32,timeout:10,jsProcessor:0,jsProcessorSize:4096,source:0,bufferSize:2048,init_page:function(){this.context=this.api=null;this.currentvalue=[];this.signal=new Float32Array(this.bufferSize);this.initAudio();null!=this.api&&this.api.name&&"webkit"==this.api.name&&(this.fft=new FFT(this.bufferSize,44100))},stop:function(){0!=this.source&&(this.stopped=!0,this.source.noteOff(0))},initAudio:function(){this.api="undefined"==typeof webkitAudioContext?
Amp.Apis.Mozilla.initialize():Amp.Apis.Webkit.initialize()},audioAvailable:function(){Amp.Manager.fft.forward(Amp.Manager.signal);for(var a=0;a<Amp.Manager.bufferSize/Amp.Manager.range;a++)Amp.Manager.currentvalue[a]=Amp.Manager.fft.spectrum[a]*Amp.Manager.ZOOM}}});
define("Amp.Request",["Amp"],function(){Amp.Request={type:"GET",initialize:function(a,b){null==a&&(a=[],a.url="");this.self=new XMLHttpRequest;this.self.open(this.type,a.url,!0);this.self.responseType="arraybuffer";this.self.onload=null!=b?b:function(){Amp.Manager.source.buffer=Amp.Manager.api.context.createBuffer(this.self.response,true);Amp.Manager.source.loop=false;Amp.Manager.source.noteOn(0);Amp.Visualizer.animate()}.bind(this);return this.self}}});
define("Amp.Visualizer",["Amp"],function(){Amp.Visualizer={canvas:document.getElementById("fft"),color:"#EEEEEE",bar_width:50,bar_gap:50,animate:function(){this.bar_height=this.canvas.height;this.ctx=this.canvas.getContext("2d");this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);this.ctx.fillStyle=this.color;for(var a=0;a<Amp.Manager.currentvalue.length;a++)this.ctx.fillRect(a*this.bar_gap,this.bar_height,this.bar_width,3*-Amp.Manager.currentvalue[a]);t=setTimeout("Amp.Visualizer.animate()",
Amp.Manager.timeout);this.stopped&&(this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),clearTimeout(t))}}});
define("Amp.Apis.Mozilla",["Amp","Amp.Apis"],function(){Amp.Apis.Mozilla={initialize:function(){this.name="mozilla";this.context=new Audio;this.context.src=Amp.Manager.ogg;this.context.addEventListener("MozAudioAvailable",this.audioAvailable.bind(this),!1);this.context.addEventListener("loadedmetadata",this.loadedMetadata.bind(this),!1);this.context.play();Amp.Visualizer.animate();return this},audioAvailable:function(a){for(var b=a.frameBuffer,d=0,f=Amp.Manager.api.context.mozFrameBufferLength/2;d<
f;d++)Amp.Manager.signal[d]=(b[2*d]+b[2*d+1])/2;Amp.Manager.audioAvailable(a)},loadedMetadata:function(){Amp.Manager.fft=new FFT(Amp.Manager.api.context.mozFrameBufferLength,Amp.Manager.api.context.mozSampleRate)}}});
define("Amp.Apis.Webkit",["Amp","Amp.Apis"],function(){Amp.Apis.Webkit={jsProcessor:0,jsProcessorSize:4096,initialize:function(){this.name="webkit";this.context=new webkitAudioContext;this.context.sampleRate=44100;Amp.Manager.source=this.context.createBufferSource();this.jsProcessor=this.context.createJavaScriptNode(this.jsProcessorSize,1,2);this.jsProcessor.onaudioprocess=this.audioAvailable.bind(this);Amp.Manager.source.connect(this.jsProcessor);this.jsProcessor.connect(this.context.destination);
this.loadSample(Amp.Manager.mp3);return this},audioAvailable:function(a){for(var b=a.inputBuffer.getChannelData(0),d=a.inputBuffer.getChannelData(1),f=a.outputBuffer.getChannelData(0),g=a.outputBuffer.getChannelData(1),e=b.length,c=0;c<e;c++)f[c]=b[c],g[c]=d[c],Amp.Manager.signal[c]=(b[c]+d[c])/2;Amp.Manager.audioAvailable(a)},loadSample:function(a){Amp.Request.initialize({url:a}).send()}}});
