(function(a){var b=null,b="undefined"!==typeof exports?exports:this.Amp={},c={};b.define=function(a,b,d){if("function"===typeof define&&define.amd)define(a,b,d);else{if(b&&b.length)for(var e=0;e<b.length;e++)b[e]=c[b[e]];c[a]=d.apply(this,b||[])}};"undefined"===typeof define&&(a.define=b.define)})("undefined"===typeof window?this:window);define("Amp.Apis",["Amp"],function(){Amp.Apis={}});
define("Amp.Manager",["Amp"],function(){Amp.Manager={ZOOM:100,range:32,timeout:10,jsProcessor:0,jsProcessorSize:4096,source:0,bufferSize:2048,init_page:function(){this.context=this.api=null;this.currentvalue=[];this.signal=new Float32Array(this.bufferSize);this.initAudio();null!=this.api&&this.api.name&&"webkit"==this.api.name&&(this.fft=new FFT(this.bufferSize,44100))},init_moz_page:function(){Amp.Manager.fft=new FFT(Amp.Manager.context.mozFrameBufferLength,Amp.Manager.context.mozSampleRate)},stop:function(){0!=
this.source&&(this.stopped=!0,this.source.noteOff(0))},initAudio:function(){"undefined"==typeof webkitAudioContext?(this.api="mozilla",Amp.Manager.context=new Audio,Amp.Manager.context.src=this.ogg,Amp.Manager.context.addEventListener("MozAudioAvailable",this.audioAvailable,!1),Amp.Manager.context.addEventListener("loadedmetadata",this.init_moz_page,!1),Amp.Manager.context.play(),Amp.Visualizer.animate()):this.api=Amp.Apis.Webkit.initialize()},audioAvailable:function(a){if(null!=this.api&&this.api.name&&
"webkit"==this.api.name)for(var b=a.inputBuffer.getChannelData(0),c=a.inputBuffer.getChannelData(1),f=a.outputBuffer.getChannelData(0),g=a.outputBuffer.getChannelData(1),d=b.length,a=0;a<d;a++)f[a]=b[a],g[a]=c[a],this.signal[a]=(b[a]+c[a])/2;else if(null!=Amp.Manager.api&&"mozilla"==Amp.Manager.api){b=a.frameBuffer;c=Amp.Manager.context.mozFrameBufferLength;a=0;for(c/=2;a<c;a++)Amp.Manager.signal[a]=(b[2*a]+b[2*a+1])/2}Amp.Manager.fft.forward(Amp.Manager.signal);for(a=0;a<Amp.Manager.bufferSize/Amp.Manager.range;a++)Amp.Manager.currentvalue[a]=
Amp.Manager.fft.spectrum[a]*Amp.Manager.ZOOM}}});define("Amp.Request",["Amp"],function(){Amp.Request={type:"GET",initialize:function(a,b){null==a&&(a=[],a.url="");this.self=new XMLHttpRequest;this.self.open(this.type,a.url,!0);this.self.responseType="arraybuffer";this.self.onload=null!=b?b:function(){Amp.Manager.source.buffer=Amp.Manager.api.context.createBuffer(this.self.response,true);Amp.Manager.source.loop=false;Amp.Manager.source.noteOn(0);Amp.Visualizer.animate()}.bind(this);return this.self}}});
define("Amp.Visualizer",["Amp"],function(){Amp.Visualizer={canvas:document.getElementById("fft"),color:"#EEEEEE",bar_width:50,bar_gap:50,animate:function(){this.bar_height=this.canvas.height;this.ctx=this.canvas.getContext("2d");this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);this.ctx.fillStyle=this.color;for(var a=0;a<Amp.Manager.currentvalue.length;a++)this.ctx.fillRect(a*this.bar_gap,this.bar_height,this.bar_width,3*-Amp.Manager.currentvalue[a]);t=setTimeout("Amp.Visualizer.animate()",
Amp.Manager.timeout);this.stopped&&(this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),clearTimeout(t))}}});
define("Amp.Apis.Webkit",["Amp","Amp.Apis"],function(){Amp.Apis.Webkit={jsProcessor:0,jsProcessorSize:4096,initialize:function(){this.name="webkit";this.context=new webkitAudioContext;this.context.sampleRate=44100;Amp.Manager.source=this.context.createBufferSource();this.jsProcessor=this.context.createJavaScriptNode(this.jsProcessorSize,1,2);this.jsProcessor.onaudioprocess=Amp.Manager.audioAvailable.bind(Amp.Manager);Amp.Manager.source.connect(this.jsProcessor);this.jsProcessor.connect(this.context.destination);
this.loadSample(Amp.Manager.mp3);return this},loadSample:function(a){Amp.Request.initialize({url:a}).send()}}});
